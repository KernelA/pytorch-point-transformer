schema: '2.0'
stages:
  download-simple-shapes:
    cmd: python ./gdownloader.py --url https://drive.google.com/file/d/1TJK0bm_HtGP-c-_l3Z-H-oQt5q0FudLw/view?usp=share_link
      --out ./datasets/raw/modelnet10.zip
    deps:
    - path: ./gdownloader.py
      md5: 1ba606b1d975c78d8694b491ced43688
      size: 456
    outs:
    - path: ./datasets/raw/modelnet10.zip
      md5: 7890527d3195af1400fb31f7d97f5a5e
      size: 71089
  download-dataset:
    cmd: python ./downloader.py --url http://vision.princeton.edu/projects/2014/3DShapeNets/ModelNet10.zip
      --out ./datasets/raw/modelnet10.zip
    deps:
    - path: ./downloader.py
      md5: c9ce0adc80a7f5f953a6d569308f782f
      size: 651
    outs:
    - path: ./datasets/raw/modelnet10.zip
      md5: 18f4c73879802c35aa6178f8e773a99e
      size: 473402300
  prepare-modelnet10:
    cmd: python ./prepare_data.py -cn train_modelnet10
    deps:
    - path: ./configs/datasets/modelnet10.yaml
      md5: 8a0c14ac2d6213cf425a3c23446d0c41
      size: 508
    - path: ./configs/prepare_dataset.yaml
      md5: a3062335adb739db6ffc0a8414f4c051
      size: 310
    - path: ./configs/transforms/simple_shapes
      md5: 73a48cb8adc25ad20914f8e98bd4b199.dir
      size: 898
      nfiles: 3
    - path: ./datasets/raw/modelnet10.zip
      md5: 4f6ca2505bf1b83a14c0688159f70ccd
      size: 375188230
    - path: ./prepare_data.py
      md5: 2ee218c9ae61d69b61a91433ac3345fe
      size: 311
    - path: ./training/data/modelnet
      md5: 2573de51c22a6a3119ffab0baf9ba1ca.dir
      size: 30307
      nfiles: 13
    outs:
    - path: ./datasets/modelnet10
      md5: 7e36fdb17a5ad5ab1422f3ac5592c156.dir
      size: 17876722
      nfiles: 910
  prepare-dataset:
    cmd: python ./prepare_data.py -cn train_modelnet10
    deps:
    - path: ./configs/datasets/modelnet10.yaml
      md5: 8685941c1a026383213575156a57def6
      size: 523
    - path: ./configs/prepare_dataset.yaml
      md5: a3062335adb739db6ffc0a8414f4c051
      size: 310
    - path: ./configs/transforms/simple_shapes
      md5: 73a48cb8adc25ad20914f8e98bd4b199.dir
      size: 898
      nfiles: 3
    - path: ./datasets/raw/modelnet10.zip
      md5: 18f4c73879802c35aa6178f8e773a99e
      size: 473402300
    - path: ./prepare_data.py
      md5: 4607881479bcff75f1ae9e22f247c596
      size: 329
    - path: ./training/data/modelnet
      md5: eecbc41cb6caab27bf904d360e8e6e0b.dir
      size: 33895
      nfiles: 13
    outs:
    - path: ./datasets/modelnet10
      md5: beeb27ffabb2ac21c0340c102893caf3.dir
      size: 186745907
      nfiles: 4901
  prepare-config:
    cmd: python ./resolve_config.py -cn train_modelnet10 model.num_transformer_blocks=5
    deps:
    - path: ./configs/train_modelnet10.yaml
      md5: a710d1c8bb4904539fe8056f0fce404a
      size: 2267
    - path: ./resolve_config.py
      md5: 55c8b471528728bfef1ba78363dd1811
      size: 344
    outs:
    - path: ./exp/modelnet10/config.yaml
      md5: 22c1a448d8a53f1a994dd9660580f303
      size: 4453
  train:
    cmd: python ./train.py -cn train_modelnet10
    deps:
    - path: ./datasets/modelnet10
      md5: beeb27ffabb2ac21c0340c102893caf3.dir
      size: 186745907
      nfiles: 4901
    - path: ./exp/modelnet10/config.yaml
      md5: 95293b0bce32c2a0eaafe26e4ebb6409
      size: 4452
    - path: ./point_transformer
      md5: 502810c7ac28232b0399e8ec5395bf4f.dir
      size: 35928
      nfiles: 32
    - path: ./train.py
      md5: 8344131d6876e11f12118a4fe1a47523
      size: 1597
    - path: ./training/metrics
      md5: 6eb4963b1f6492193ad909a37a42fdb0.dir
      size: 2221
      nfiles: 4
    - path: ./training/trainers
      md5: 92ad386bfcbf245ed316c574eaac5b80.dir
      size: 12258
      nfiles: 5
    params:
      exp/modelnet10/config.yaml:
        model:
          _target_: point_transformer.models.cls_network.ClsPointTransformer
          in_features: 6
          num_transformer_blocks: 5
          num_classes: ???
        optimizer:
          _target_: torch.optim.Adam
          lr: 0.0001
          betas:
          - 0.9
          - 0.999
          amsgrad: true
          weight_decay: 0.0001
        params:
          seed: 300
          precision: 16
          max_epochs: 200
          train_batch_size: 32
          test_batch_size: 128
        scheduler:
          _target_: torch.optim.lr_scheduler.MultiStepLR
          milestones:
          - 120
          - 160
          gamma: 0.1
        test_transform:
          _target_: torch_geometric.transforms.Compose
          transforms:
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 0
            degrees: 180
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 2
            degrees: 180
        train_transform:
          _target_: torch_geometric.transforms.Compose
          transforms:
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 0
            degrees: 180
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 2
            degrees: 180
    outs:
    - path: ./exp/modelnet10/exp
      md5: 803ce47394e615ecca000496fff7036b.dir
      size: 4580
      nfiles: 2
