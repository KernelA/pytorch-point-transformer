schema: '2.0'
stages:
  download-simple-shapes:
    cmd: python ./gdownloader.py --url https://drive.google.com/uc?id=1xM5diKjMbp_PfNu--JG2A-ZeFk9TLkks
      --out ./datasets/raw/simple-shapes-dataset-v2.zip
    deps:
    - path: ./gdownloader.py
      md5: 1ba606b1d975c78d8694b491ced43688
      size: 456
    outs:
    - path: ./datasets/raw/simple-shapes-dataset-v2.zip
      md5: 2d5e4e21ffe498e34588f9bfbae18d98
      size: 10365251
  prepare-simple-shapes:
    cmd: python ./prepare_data.py -cn train_simple_shapes
    deps:
    - path: ./configs/datasets/simple_shapes.yaml
      md5: 43cd33048a5551d92ba50c1798c77eee
      size: 507
    - path: ./configs/prepare_dataset.yaml
      md5: a3062335adb739db6ffc0a8414f4c051
      size: 310
    - path: ./configs/transforms/simple_shapes
      md5: 73a48cb8adc25ad20914f8e98bd4b199.dir
      size: 898
      nfiles: 3
    - path: ./datasets/raw/simple-shapes-dataset-v2.zip
      md5: 2d5e4e21ffe498e34588f9bfbae18d98
      size: 10365251
    - path: ./prepare_data.py
      md5: 2ee218c9ae61d69b61a91433ac3345fe
      size: 311
    - path: ./training/data/simple_shapes.py
      md5: 87d838f8c754a07e804f6b15f942c717
      size: 5320
    outs:
    - path: ./datasets/simple_shapes
      md5: 6f18211595f4e4f08145c20543d26207.dir
      size: 33240140
      nfiles: 4
  prepare-config-simple-shapes:
    cmd: python ./resolve_config.py -cn train_simple_shapes
    deps:
    - path: ./configs/train_simple_shapes.yaml
      md5: 9d217c9370edd6dfe2b5ccd3e52587dc
      size: 2036
    - path: ./resolve_config.py
      md5: 6169ae480892976a0060dbed5149cf31
      size: 328
    outs:
    - path: ./exp/simple_shapes/config.yaml
      md5: febe9c669e73efb9cd874218943a2018
      size: 4471
  train-simple-shapes:
    cmd: python ./train.py -cn train_simple_shapes
    deps:
    - path: ./datasets/simple_shapes
      md5: 98a45613a61306a96d14699372054c61.dir
      size: 33240140
      nfiles: 4
    - path: ./exp/simple_shapes/config.yaml
      md5: febe9c669e73efb9cd874218943a2018
      size: 4471
    - path: ./point_transformer
      md5: 27be713e89484f96b2663e2bc895b2f6.dir
      size: 35277
      nfiles: 32
    - path: ./train.py
      md5: 568f8cf5063d6399b4f62dbce20f1206
      size: 1547
    - path: ./training/metrics
      md5: c698c8f22d3eab27ebfec2ee55d45d29.dir
      size: 2221
      nfiles: 4
    - path: ./training/trainers
      md5: d9805bab8b426825fb911b8fe831404d.dir
      size: 9561
      nfiles: 5
    params:
      exp/simple_shapes/config.yaml:
        model:
          _target_: point_transformer.models.cls_network.ClsPointTransformer
          in_features: 6
          num_transformer_blocks: 3
          num_classes: ???
        optimizer:
          _target_: torch.optim.Adam
          lr: 0.0001
          betas:
          - 0.9
          - 0.999
          amsgrad: true
          weight_decay: 0.0001
        params:
          seed: 300
          precision: 32
          max_epochs: 10
          train_batch_size: 32
          test_batch_size: 128
        scheduler:
          _target_: torch.optim.lr_scheduler.MultiStepLR
          milestones:
          - 120
          - 160
          gamma: 0.1
        test_transform:
          _target_: torch_geometric.transforms.Compose
          transforms:
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 0
            degrees: 180
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 2
            degrees: 180
        train_transform:
          _target_: torch_geometric.transforms.Compose
          transforms:
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 0
            degrees: 180
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 2
            degrees: 180
    outs:
    - path: ./exp/simple_shapes/exp
      md5: ea78a3b6d12aee858580db039ba827fc.dir
      size: 153534811
      nfiles: 6
  download:
    cmd: gdown https://drive.google.com/uc?id=1xM5diKjMbp_PfNu--JG2A-ZeFk9TLkks -O
      ./datasets/raw/simple-shapes-dataset-v2.zip
    outs:
    - path: ./datasets/raw/simple-shapes-dataset-v2.zip
      md5: 2d5e4e21ffe498e34588f9bfbae18d98
      size: 10365251
  prepare-dataset:
    cmd: python ./prepare_data.py -cn train_simple_shapes
    deps:
    - path: ./configs/datasets/simple_shapes.yaml
      md5: 43cd33048a5551d92ba50c1798c77eee
      size: 507
    - path: ./configs/prepare_dataset.yaml
      md5: a3062335adb739db6ffc0a8414f4c051
      size: 310
    - path: ./configs/transforms/simple_shapes
      md5: c1a30a3305b4502a2ece78a0265c8bf9.dir
      size: 714
      nfiles: 3
    - path: ./datasets/raw/simple-shapes-dataset-v2.zip
      md5: 2d5e4e21ffe498e34588f9bfbae18d98
      size: 10365251
    - path: ./prepare_data.py
      md5: 7679b746ebc4697606c492d053bce1a5
      size: 421
    - path: ./training/data/simple_shapes.py
      md5: 933493e62733324cf4742193df3ee95f
      size: 5417
    outs:
    - path: ./datasets/simple_shapes
      md5: 0645dab74d5d202f2ea62ac8065e30e4.dir
      size: 33240140
      nfiles: 4
  prepare-config:
    cmd: python ./resolve_config.py -cn train_simple_shapes
    deps:
    - path: ./configs/datasets/simple_shapes.yaml
      md5: 43cd33048a5551d92ba50c1798c77eee
      size: 507
    - path: ./configs/model/cls_model.yaml
      md5: 348503f0903d4862c9f0fbcbd62f8755
      size: 131
    - path: ./configs/optimizer/adam.yaml
      md5: e5e3f42c89ab440608a4c14e2c150ad3
      size: 94
    - path: ./configs/optimizer/sgd.yaml
      md5: f4b9eaf84584fa2e3d1d5253b284ab48
      size: 72
    - path: ./configs/scheduler/multistep.yaml
      md5: 86df11af57086580e0dd7c248d323403
      size: 84
    - path: ./configs/train_simple_shapes.yaml
      md5: b3b5cb74eb19b537ce17079efdffa267
      size: 2029
    - path: ./configs/transforms/simple_shapes
      md5: c1a30a3305b4502a2ece78a0265c8bf9.dir
      size: 714
      nfiles: 3
    - path: ./resolve_config.py
      md5: 55c8b471528728bfef1ba78363dd1811
      size: 344
    outs:
    - path: ./exp/simple_shapes/config.yaml
      md5: 7ba2114d7a983ca16bb5570642632a24
      size: 4343
  train:
    cmd: python ./train.py -cn config -cp ./exp/simple_shapes
    deps:
    - path: ./datasets/simple_shapes
      md5: 0645dab74d5d202f2ea62ac8065e30e4.dir
      size: 33240140
      nfiles: 4
    - path: ./exp/simple_shapes/config.yaml
      md5: 7ba2114d7a983ca16bb5570642632a24
      size: 4343
    - path: ./point_transformer
      md5: 8ffe2aeed9c712115e0c5ca26e2e67c9.dir
      size: 36920
      nfiles: 32
    - path: ./train.py
      md5: 241ec7bb8e91cf5dc9524e4fbb1ebd3d
      size: 2382
    - path: ./training/metrics
      md5: 6eb4963b1f6492193ad909a37a42fdb0.dir
      size: 2221
      nfiles: 4
    - path: ./training/trainers
      md5: f38fd18eec6b921ee0b043da9ed7adea.dir
      size: 13976
      nfiles: 5
    params:
      exp/simple_shapes/config.yaml:
        model:
          _target_: point_transformer.models.cls_network.ClsPointTransformer
          in_features: 6
          num_transformer_blocks: 3
          num_classes: ???
        optimizer:
          _target_: torch.optim.Adam
          lr: 0.0001
          betas:
          - 0.9
          - 0.999
          amsgrad: true
          weight_decay: 0.0001
        params:
          seed: 300
          precision: 16
          max_epochs: 10
          train_batch_size: 32
          test_batch_size: 128
        scheduler:
          _target_: torch.optim.lr_scheduler.MultiStepLR
          milestones:
          - 120
          - 160
          gamma: 0.1
        test_transform:
          _target_: torch_geometric.transforms.Compose
          transforms:
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 2
            degrees: 180
        train_transform:
          _target_: torch_geometric.transforms.Compose
          transforms:
          - _target_: torch_geometric.transforms.RandomRotate
            axis: 2
            degrees: 180
    outs:
    - path: ./exp/simple_shapes/exp
      md5: 32c9a7a1fd53fdd6285d595419fc5497.dir
      size: 4418
      nfiles: 2
